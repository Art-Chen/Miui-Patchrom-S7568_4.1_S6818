*** ./smali/com/android/server/wm/WindowState.smali	2015-04-19 13:47:31.965103250 +0800
--- /home/art-chen/MIUI/v5/s7568/temp/new_smali/services.jar.out/./smali/com/android/server/wm/WindowState.smali	2015-04-19 13:49:01.677106600 +0800
***************
*** 36,41 ****
--- 36,43 ----
  
  .field final mAttachedWindow:Lcom/android/server/wm/WindowState;
  
+ .field mAttrFlagsSaved:Z
+ 
  .field final mAttrs:Landroid/view/WindowManager$LayoutParams;
  
  .field final mBaseLayer:I
***************
*** 79,84 ****
--- 81,88 ----
  
  .field mExiting:Z
  
+ .field final mFloatingWindowAllowed:Z
+ 
  .field final mFrame:Landroid/graphics/Rect;
  
  .field final mGivenContentInsets:Landroid/graphics/Rect;
***************
*** 99,104 ****
--- 103,110 ----
  
  .field mInputChannel:Landroid/view/InputChannel;
  
+ .field mInputChannelSaved:Landroid/view/InputChannel;
+ 
  .field final mInputWindowHandle:Lcom/android/server/input/InputWindowHandle;
  
  .field mInvGlobalScale:F
***************
*** 673,678 ****
--- 679,688 ----
  
      iput-object v5, p0, Lcom/android/server/wm/WindowState;->mWinAnimator:Lcom/android/server/wm/WindowStateAnimator;
  
+     const/4 v5, 0x0
+ 
+     iput-boolean v5, p0, Lcom/android/server/wm/WindowState;->mFloatingWindowAllowed:Z
+ 
      .end local v3           #e:Landroid/os/RemoteException;
      :goto_7
      return-void
***************
*** 868,873 ****
--- 878,893 ----
  
      iput-object v6, p0, Lcom/android/server/wm/WindowState;->mInputWindowHandle:Lcom/android/server/input/InputWindowHandle;
  
+     iget-object v5, p0, Lcom/android/server/wm/WindowState;->mSession:Lcom/android/server/wm/Session;
+ 
+     iget v5, v5, Lcom/android/server/wm/Session;->mUid:I
+ 
+     invoke-static {v5}, Lcom/android/server/wm/WindowManagerService$Injector;->isFloatingWindowAllowed(I)Z
+ 
+     move-result v5
+ 
+     iput-boolean v5, p0, Lcom/android/server/wm/WindowState;->mFloatingWindowAllowed:Z
+ 
      goto/16 :goto_7
  
      .restart local v4       #parent:Lcom/android/server/wm/WindowToken;
